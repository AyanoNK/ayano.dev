---
// Automatic language detection and redirect
// This page should only be seen briefly while redirecting
const supportedLocales = ["en", "es", "ja"];
const defaultLocale = "en";

// Return early to let client-side redirect handle it
// We can't access browser language on the server in Astro SSG
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Redirecting...</title>
    <script is:inline>
      // Detect user's preferred language from browser
      function detectLanguage() {
        const supportedLocales = ["en", "es", "ja"];
        const defaultLocale = "en";

        // Get browser languages
        const browserLanguages = navigator.languages || [
          navigator.language || navigator.userLanguage,
        ];

        // Find first matching supported locale
        for (const lang of browserLanguages) {
          // Extract base language code (e.g., 'en' from 'en-US')
          const baseLanguage = lang.split("-")[0].toLowerCase();

          if (supportedLocales.includes(baseLanguage)) {
            return baseLanguage;
          }
        }

        return defaultLocale;
      }

      // Perform redirect
      const detectedLang = detectLanguage();
      window.location.href = `/${detectedLang}/`;
    </script>
  </head>
  <body>
    <div
      style="display: flex; justify-content: center; align-items: center; height: 100vh; font-family: sans-serif;">
      <p>Redirecting to your preferred language...</p>
    </div>
  </body>
</html>
